\chapter{Twitter上の情報を用いた提案認証システム}\label{chap:system}
\section{システムの概要}
本論文における提案システムとして，前章の内容を踏まえて，利便性(憶えやすさ，使いやすさ)と安全性の両立を目指した個人認証手法を実装した(以下Notifauth)．
Notifauth起動時の画面は図\ref{fig:notifauthHome}のようになっており，この画面から新規登録画面(図\ref{fig:notifauthLogin})\footnote{Twitterと連携するためOAuthを用いた}への遷移，設定画面への遷移，実験の試行を開始，実験結果の送信を行うことが可能となっている．

\subsection{秘密情報の設定}\label{subsec:selectSecret}
この手法を用いた秘密の設定方法として，
\begin{description}
  \item[Auto Mode Type Term]\mbox{}\\
    ○日/週/月/年前から△日~年間を指定し，認証時点にその範囲に当てはまるツイートが秘密情報となる(図\ref{fig:notifauthAutoTerm})
  \item[Auto Mode Type Cycle]\mbox{}\\
    ○曜日の△時台という条件に当てはまるツイートが秘密情報となる(図\ref{fig:notifauthAutoCycle})
  \item[Manual Mode]\mbox{}\\
    自分のツイートから任意に1つ秘密情報となるものを選ぶ(図\ref{fig:notifauthManual})
\end{description}
以上の3つを実装した．

\begin{figure}[ht]
  \begin{minipage}{0.5\hsize}
    \begin{center}
      \includegraphics[width=60mm]{img/notifauthAutoTerm.eps}
    \end{center}
    \caption{Auto Mode Type Termの設定画面}
    \label{fig:notifauthAutoTerm}
  \end{minipage}
  \begin{minipage}{0.5\hsize}
    \begin{center}
      \includegraphics[width=60mm]{img/notifauthAutoCycle.eps}
    \end{center}
    \caption{Auto Mode Type Cycleの設定画面}
    \label{fig:notifauthAutoCycle}
  \end{minipage}
\end{figure}

次に，各設定方法の概要を説明する．

Auto Mode Type Termでは，画面上段の「CONDITION」においてスライダーを用いて「From」(どのくらい前のツイートから秘密情報とするか)と「Term」(Fromからどのくらいの期間のツイートを秘密情報とするか)を設定する．
各スライダーの最大値は，Notifauthによって取得しデータベースに保持されているツイートの中から最も古いものを基準として用いる．
また，画面下段の「EXAMPLE」に，秘密情報として該当するツイートの一部(1行目が最古のもの，3行目が最新のもの，2行目はツイート群の配列の中央値のもの)を表示し，ユーザが設定を簡単に行えるための指標とする．

Auto Mode Type Cycleでは，画面上段の「CONDITION」においてピッカーを用いて「Time slot」(1時間単位で，何時のツイートを秘密情報とするか)を，セレクターを用いて「Weekday」(何曜日のツイートを秘密情報とするか)を設定する．
また，画面中段の「EXAMPLE」に，秘密情報として該当するツイートの一部(1行目が最古のもの，3行目が最新のもの，2行目はツイート群の配列の中央値のもの)を表示し，画面下段の「SUGGESTION」にはNotifauthによって取得しデータベースに保持されているツイートの中で投稿回数が多い曜日・時間の組み合わせを上位3つ表示する．
これらを参考にすることでユーザが設定を簡単に行えると考えられる．

\begin{figure}
  \begin{center}
    \includegraphics[width=60mm]{img/notifauthManual.eps}
  \end{center}
  \caption{Manual Modeの設定画面}
  \label{fig:notifauthManual}
\end{figure}

Manual Modeでは，直近のツイートを最大200件取得し，これのうちどれを秘密情報とするかを手動で選択し設定する．
ここで設定したツイートは，もう一度設定しない限りは実験終了まで固定されたままである．

\subsection{認証操作}
認証操作としてiOSに実装されているロック画面上の通知とその選択操作(図\ref{fig:notificationSliding}\footnote{この場面ではスライドすることでロック解除後に受信したメールをすぐに読むことができる})を踏襲したものを採用した．
理由として，
\begin{enumerate}
  \item 本システムは携帯端末における認証の多要素化を目指して実装され，その際開発環境であるiOSでそういった操作を行えるのはロック画面のみであったため
  \item ロック画面で通知をスライドし選択する動作はiOS標準の機能であり，ユーザへ新たな操作を覚えさせる負担が少ないと考えたため
\end{enumerate}
が挙げられる．
また，実験を行いやすくするために本論文中の実装では，上記のロック画面を模した環境(図\ref{fig:notifauthNotificationTest}，図\ref{fig:notifauthPINTest})をアプリケーション内に実装した．

\begin{figure}[ht]
  \begin{center}
    \epsfig{file=img/notificationSliding.eps,scale=0.35}
  \end{center}
  \caption{ロック画面上における通知の選択(スライド)動作の例}
  \label{fig:notificationSliding}
\end{figure}

\begin{figure}[ht]
  \begin{minipage}{0.5\hsize}
    \begin{center}
      \includegraphics[width=60mm]{img/notifauthNotificationTest.eps}
    \end{center}
    \caption{ロック画面における通知の表示画面を模した認証画面}
    \label{fig:notifauthNotificationTest}
  \end{minipage}
  \begin{minipage}{0.5\hsize}
    \begin{center}
      \includegraphics[width=60mm]{img/notifauthPINTest.eps}
    \end{center}
    \caption{ロック画面におけるPINの入力画面を模した認証画面}
    \label{fig:notifauthPINTest}
  \end{minipage}
\end{figure}

\subsection{前提条件}
システムを利用するのに必要な条件や，実装の際に用いた環境などを表\ref{tbl:requirements}に記す．

\begin{table}[htpb]
  \begin{center}
    \caption{必要環境等}
    \label{tbl:requirements}
    \vspace{4mm}
    \begin{tabular}{|l||c|}
    \hline
    必要条件 & iOS7を利用し，Twitterアカウントを保持していること \\
    推奨条件 & 定期的に複数のツイートを行っていること \\
    事前準備 & TwitterのOAuthを用いて本ソフトウェアと連携する \\
    実装環境 & Mac OSX 10.9, Xcode5 \\
    動作確認環境 & iPhone 4，iPhone 4S，iPhone 5，iPhone 5S，iPod touch \\
    \hline
    \end{tabular}
  \end{center}
\end{table}

\section{実装の詳細}
%(実装に関しては〜のはなし．クラス図とか概略図を入れたほうがよさそう)
Notifauthは，iOS用アプリケーションとして実装された．
クラス図は図\ref{fig:notifauthClass}の通りである．

\begin{figure}[ht]
  \begin{center}
    \epsfig{file=img/notifauthClass.eps,scale=0.2}
  \end{center}
  \caption{Notifauthのクラス図}
  \label{fig:notifauthClass}
\end{figure}

Twitterの認証情報(OAuthの認証トークン)は，Apple社の``Keychain''により，暗号化し保存されている．
ツイートのデータは，Object-relational mapping(以降ORM)フレームワークであるCoreDataを用いてSQLiteファイルに保存されている．
また，Notifauth内の様々な設定情報はiOS標準のNSUserDefaultsオブジェクトを利用しアプリケーションソフトウェア内の専用領域に保存されており．今回は特に暗号化は行っていない．

使用したサードパーティ製ライブラリは
\begin{itemize}
\item MagicalRecord
\item MKNetworkKit
\item RSOAuthEngine
\item RSTwitterEngine
\item NSDate-Utilities
\end{itemize}
である．

ソースコードは付録\ref{apdx:code}にある通り，Webで一般公開されている．

\section{具体的特徴}\label{sec:feature}
\subsection{時間経過による秘密情報の変化}
Auto Mode Type Termにおいて，設定を行った時から時間が経過すると秘密情報とするツイートが入れ替わる場合がある．
これが成立することの利点としては，
\begin{itemize}
  \item 定期的な秘密情報の変更を能動的に行う必要が低減される
  \item 設定した期間等が秘匿されている限り，出現頻度による攻撃がしにくくなる可能性がある
\end{itemize}
が挙げられる．

また，Auto Mode Type Cycleにおいては，
\begin{itemize}
  \item 新たな秘密情報の候補が出現することで，統計的手法を用いた攻撃に対し強度が高くなる可能性がある
\end{itemize}
ということも利点として考えられる．

欠点としては以下のようなものが挙げられる．
\begin{itemize}
  \item ユーザの本人認証率が下がる可能性がある
  \item 期間の設定やツイートの頻度によっては，ダミーの数が減りすぎることで，統計的手法を用いた攻撃に脆弱になる恐れがある
\end{itemize}

本研究では，以上の利点が本当に作用するかどうかの検証実験も行った．

\newpage

